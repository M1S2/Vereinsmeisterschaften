<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Doxygen Awesome" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>Vereinsmeisterschaften: /github/workspace/Vereinsmeisterschaften.Core/Services/DocumentService.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/M1S2/Vereinsmeisterschaften" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vereinsmeisterschaften
   &#160;<span id="projectnumber">561a236def4a8107af435461f1d44caeca6d9ae8</span>
   </div>
   <div id="projectbrief">This is a software that can be used to manage the internal competition of the swimming club Illertissen called &quot;Vereinsmeisterschaften&quot;. It takes place once a year.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_document_service_8cs_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">DocumentService.cs</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="keyword">using </span>Xceed.Words.NET;</div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="keyword">using </span><a class="code hl_namespace" href="namespace_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services.html">Vereinsmeisterschaften.Core.Contracts.Services</a>;</div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="keyword">using </span><a class="code hl_namespace" href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html">Vereinsmeisterschaften.Core.Models</a>;</div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="keyword">using </span><a class="code hl_namespace" href="namespace_vereinsmeisterschaften_1_1_core_1_1_helpers.html">Vereinsmeisterschaften.Core.Helpers</a>;</div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="keyword">using </span><a class="code hl_namespace" href="namespace_vereinsmeisterschaften_1_1_core_1_1_settings.html">Vereinsmeisterschaften.Core.Settings</a>;</div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="keyword">using </span><a class="code hl_namespace" href="namespace_vereinsmeisterschaften_1_1_core_1_1_documents.html">Vereinsmeisterschaften.Core.Documents</a>;</div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_vereinsmeisterschaften_1_1_core_1_1_services.html">Vereinsmeisterschaften.Core.Services</a></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>{</div>
<div class="foldopen" id="foldopen00013" data-start="{" data-end="};">
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno"><a class="line" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html">   13</a></span>    <span class="keyword">public</span> <span class="keyword">class </span><a class="code hl_function" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a10fc047595a0f0ff3577db543e39e1d1">DocumentService</a> : <a class="code hl_interface" href="interface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_document_service.html">IDocumentService</a></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>    {</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>        <span class="keyword">private</span> <span class="keyword">const</span> <span class="keywordtype">string</span> _tempFolderName = <span class="stringliteral">&quot;temp&quot;</span>;</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>        <span class="comment">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>        <span class="keyword">private</span> <a class="code hl_interface" href="interface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_workspace_service.html">IWorkspaceService</a> _workspaceService;        </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>        <span class="keyword">private</span> readonly IEnumerable&lt;IDocumentStrategy&gt; _documentStrategies;</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span></div>
<div class="foldopen" id="foldopen00027" data-start="{" data-end="}">
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a10fc047595a0f0ff3577db543e39e1d1">   27</a></span>        <span class="keyword">public</span> <a class="code hl_function" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a10fc047595a0f0ff3577db543e39e1d1">DocumentService</a>(<a class="code hl_interface" href="interface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_workspace_service.html">IWorkspaceService</a> workspaceService, IEnumerable&lt;IDocumentStrategy&gt; documentStrategies)</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>        {</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>            _workspaceService = workspaceService;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>            _documentStrategies = documentStrategies;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>        }</div>
</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>        <span class="keyword">private</span> <a class="code hl_interface" href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html">IDocumentStrategy</a> getDocumentStrategy(<a class="code hl_enumeration" href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html#a6b47c461f6af89e3ba40e8c49fbba9a6">DocumentCreationTypes</a> type)</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>            =&gt; _documentStrategies.FirstOrDefault(s =&gt; s.DocumentType == type) ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException($<span class="stringliteral">&quot;No strategy found for {type}&quot;</span>);</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a36a317416e47c4cfacf4fbf4d686507f">   39</a></span>        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code hl_property" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a36a317416e47c4cfacf4fbf4d686507f">PlaceholderMarker</a></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>            =&gt; _workspaceService?.Settings?.GetSettingValue&lt;<span class="keywordtype">string</span>&gt;(<a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.GROUP_DOCUMENT_CREATION, <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.SETTING_DOCUMENT_CREATION_PLACEHOLDER_MARKER) ?? <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>        <span class="comment">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span></div>
<div class="foldopen" id="foldopen00050" data-start="{" data-end="}">
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno"><a class="line" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#aa85ca40e7ac2bab05913439772a313b0">   50</a></span>        <span class="keyword">public</span> Task&lt;(int, string)&gt; <a class="code hl_function" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#aa85ca40e7ac2bab05913439772a313b0">CreateDocument</a>(<a class="code hl_enumeration" href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html#a6b47c461f6af89e3ba40e8c49fbba9a6">DocumentCreationTypes</a> documentType, <span class="keywordtype">bool</span> createPdf = <span class="keyword">true</span>)</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        {</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>            <span class="keywordflow">return</span> Task.Run(() =&gt;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>            {</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>                <span class="keywordtype">int</span> numCreatedPages = 0;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>                <span class="keywordtype">string</span> documentOutputFolder = <a class="code hl_function" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a873032517f3fee3b737099eb78051216">GetDocumentPathAbsolute</a>(<a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.SETTING_DOCUMENT_CREATION_OUTPUT_FOLDER, _workspaceService);</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>                <span class="keywordflow">if</span> (!Directory.Exists(documentOutputFolder))</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>                {</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>                    Directory.CreateDirectory(documentOutputFolder);</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>                }</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>                <a class="code hl_interface" href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html">IDocumentStrategy</a> documentStrategy = getDocumentStrategy(documentType);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>                <span class="keywordtype">string</span> documentTemplate = documentStrategy.<a class="code hl_property" href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a2903114b63845445b2372b5279b2150e">TemplatePath</a>;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>                <span class="keywordflow">if</span> (Path.GetExtension(documentTemplate) != <span class="stringliteral">&quot;.docx&quot;</span>)</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>                {</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>                    <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException($<span class="stringliteral">&quot;Document template \&quot;{documentTemplate}\&quot; is not a .docx file.&quot;</span>);</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>                }</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>                <span class="comment">// Create the output file name. The TemplateFileNamePostfixReplaceStr is created based on the filter.</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>                <span class="keywordtype">string</span> outputFileNameDocx = Path.GetFileNameWithoutExtension(documentTemplate);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>                <span class="keywordtype">string</span> templateFileNamePostfix = _workspaceService?.Settings?.GetSettingValue&lt;<span class="keywordtype">string</span>&gt;(<a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.GROUP_DOCUMENT_CREATION, <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.SETTING_DOCUMENT_CREATION_TEMPLATE_FILENAME_POSTFIX) ?? <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>                <span class="keywordtype">string</span> templateFileNamePostfixReplaceStr = documentStrategy.<a class="code hl_property" href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a1d9a55ba05b8eb490c1bd9e3b77ed973">TemplateFileNamePostfixReplaceStr</a>;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>                <span class="keywordflow">if</span> (outputFileNameDocx.Contains(templateFileNamePostfix))</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>                {</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>                    outputFileNameDocx = outputFileNameDocx.Replace(templateFileNamePostfix, templateFileNamePostfixReplaceStr);</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>                }</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>                {</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>                    outputFileNameDocx += templateFileNamePostfixReplaceStr;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>                }</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>                outputFileNameDocx += <span class="stringliteral">&quot;.docx&quot;</span>;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>                <span class="keywordtype">string</span> outputFile = Path.Combine(documentOutputFolder, outputFileNameDocx);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>                <span class="comment">// Collect all items used to create the document</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>                <span class="keywordtype">object</span>[] items = documentStrategy.<a class="code hl_function" href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a3db0d616407285492a03ef73862e1d72">GetItems</a>();</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>                <span class="keywordtype">string</span> placeholderMarker = <a class="code hl_property" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a36a317416e47c4cfacf4fbf4d686507f">PlaceholderMarker</a>;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                <span class="comment">// Decide whether to create multiple pages or not</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>                <span class="keywordflow">if</span> (documentStrategy.<a class="code hl_property" href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#ad422ea96c4cc00099cc5846bc1d2088c">CreateMultiplePages</a>)</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>                {</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>                    <span class="comment">// Create a temp folder to store all pages as single documents</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>                    <span class="keywordtype">string</span> tempFolder = Path.Combine(documentOutputFolder, _tempFolderName);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>                    <span class="keywordflow">try</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>                    {</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>                        <span class="comment">// Delete temp folder and all files in it</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>                        <span class="keywordflow">if</span> (Directory.Exists(tempFolder))</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>                        {</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>                            Directory.Delete(tempFolder, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>                        }</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>                        Directory.CreateDirectory(tempFolder);</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>                                                </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                        <span class="keywordflow">if</span> (items != <span class="keyword">null</span> &amp;&amp; items.Length &gt; 0)</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>                        {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>                            <span class="keywordflow">foreach</span> (<span class="keywordtype">object</span> multiplePagesObj <span class="keywordflow">in</span> items)</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>                            {</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>                                <span class="comment">// Create the filename for the temporary file containing one page of the final multi pages document. Make sure the postfix number always contain an equal number of digits (prefixed by 0). This is important later for Directory.GetFiles() ordering.</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                                <span class="keywordtype">string</span> outputFileMulti = Path.Combine(tempFolder, Path.GetFileNameWithoutExtension(documentTemplate).Replace(templateFileNamePostfix, <span class="stringliteral">&quot;&quot;</span>) + $<span class="stringliteral">&quot;_{numCreatedPages:0000}.docx&quot;</span>);</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                                <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_helpers_1_1_doc_x_placeholder_helper_1_1_table_placeholders.html">DocXPlaceholderHelper.TablePlaceholders</a> tablePlaceholders = documentStrategy.<a class="code hl_function" href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a95b76fb6866ec717c5411ef8a778a93e">ResolveTablePlaceholders</a>(items);</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>                                <span class="keywordflow">if</span> (tablePlaceholders != <span class="keyword">null</span>) { DocXPlaceholderHelper.ReplaceTablePlaceholders(documentTemplate, outputFileMulti, tablePlaceholders, placeholderMarker); }</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                                <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_helpers_1_1_doc_x_placeholder_helper_1_1_text_placeholders.html">DocXPlaceholderHelper.TextPlaceholders</a> textPlaceholders = documentStrategy.<a class="code hl_function" href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a8f0fafd9aa6d86ee68e307db4f5e835f">ResolveTextPlaceholders</a>(multiplePagesObj);</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                                <span class="keywordflow">if</span> (textPlaceholders != <span class="keyword">null</span>) { DocXPlaceholderHelper.ReplaceTextPlaceholders(tablePlaceholders == <span class="keyword">null</span> ? documentTemplate : outputFileMulti, outputFileMulti, textPlaceholders, placeholderMarker); }</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                                <a class="code hl_function" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#ac9621bfd2c56d668d329e274a6463164">insertAlwaysSupportedPlaceholderValues</a>(outputFileMulti, outputFileMulti);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                                numCreatedPages++;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>                            }</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>                            <span class="comment">// Combine all docx files in the temp folder into one docx file</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>                            <span class="keywordtype">string</span>[] files = Directory.GetFiles(tempFolder);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>                            <span class="keywordflow">if</span> (files.Length &gt; 0)</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>                            {</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>                                <span class="comment">// Copy the first document as the base for the output file</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                                File.Copy(files[0], outputFile, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>                                <span class="keyword">using</span> (DocX document = DocX.Load(outputFile))</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>                                {</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>                                    <span class="comment">// Append all other documents to the first one</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; files.Length; i++)</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                                    {</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                                        <span class="keyword">using</span> (DocX tempDocument = DocX.Load(files[i]))</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>                                        {</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                                            document.InsertDocument(tempDocument, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                                        }</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                                    }</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                                    document.Save();</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>                                }</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                            }</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                        }</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                    }</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                    <span class="keywordflow">catch</span> (Exception)</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                    {</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>                        <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>                    }</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>                    <span class="keywordflow">finally</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>                    {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>                        <span class="comment">// Delete temp folder and all files in it</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>                        <span class="keywordflow">if</span> (Directory.Exists(tempFolder))</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>                        {</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>                            Directory.Delete(tempFolder, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>                        }</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>                    }</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>                }</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>                {</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                    <span class="comment">// Create a single page document</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                    <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_helpers_1_1_doc_x_placeholder_helper_1_1_table_placeholders.html">DocXPlaceholderHelper.TablePlaceholders</a> tablePlaceholders = documentStrategy.<a class="code hl_function" href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a95b76fb6866ec717c5411ef8a778a93e">ResolveTablePlaceholders</a>(items);</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>                    <span class="keywordflow">if</span> (tablePlaceholders != <span class="keyword">null</span>) { DocXPlaceholderHelper.ReplaceTablePlaceholders(documentTemplate, outputFile, tablePlaceholders, placeholderMarker); }</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>                    <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_helpers_1_1_doc_x_placeholder_helper_1_1_text_placeholders.html">DocXPlaceholderHelper.TextPlaceholders</a> textPlaceholders = documentStrategy.<a class="code hl_function" href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a8f0fafd9aa6d86ee68e307db4f5e835f">ResolveTextPlaceholders</a>();</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>                    <span class="keywordflow">if</span> (textPlaceholders != <span class="keyword">null</span>) { DocXPlaceholderHelper.ReplaceTextPlaceholders(tablePlaceholders == <span class="keyword">null</span> ? documentTemplate : outputFile, outputFile, textPlaceholders, placeholderMarker); }</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>                    <a class="code hl_function" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#ac9621bfd2c56d668d329e274a6463164">insertAlwaysSupportedPlaceholderValues</a>(outputFile, outputFile);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>                    numCreatedPages = 1; <span class="comment">// We created one page for the document</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>                }</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>                <a class="code hl_enumeration" href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html#a82b1066b34f9619bf8152e98cdb094a9">DocumentCreationFileTypes</a> fileTypes = _workspaceService?.Settings?.GetSettingValue&lt;<a class="code hl_enumeration" href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html#a82b1066b34f9619bf8152e98cdb094a9">DocumentCreationFileTypes</a>&gt;(<a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.GROUP_DOCUMENT_CREATION, <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.SETTING_DOCUMENT_CREATION_FILE_TYPES) ?? <a class="code hl_enumeration" href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html#a82b1066b34f9619bf8152e98cdb094a9">DocumentCreationFileTypes</a>.DOCX_AND_PDF;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>                <span class="keywordtype">string</span> returnFilePath = outputFile;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>                <span class="comment">// Create PDF if requested and file type is PDF or DOCX_AND_PDF</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>                <span class="keywordflow">if</span> (createPdf &amp;&amp; (fileTypes == <a class="code hl_enumeration" href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html#a82b1066b34f9619bf8152e98cdb094a9">DocumentCreationFileTypes</a>.PDF || fileTypes == <a class="code hl_enumeration" href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html#a82b1066b34f9619bf8152e98cdb094a9">DocumentCreationFileTypes</a>.DOCX_AND_PDF))</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                {</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                    returnFilePath = <a class="code hl_function" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#af455da544a8f265aa46c09d00870f10b">convertToPdf</a>(outputFile);</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                }</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>                <span class="comment">// Delete the .docx file if file type is PDF</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>                <span class="keywordflow">if</span> (fileTypes == <a class="code hl_enumeration" href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html#a82b1066b34f9619bf8152e98cdb094a9">DocumentCreationFileTypes</a>.PDF)</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                {</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>                    <span class="keywordflow">if</span> (File.Exists(outputFile))</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>                    {</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>                        File.Delete(outputFile);</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                    }</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>                }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>                <span class="keywordflow">return</span> (numCreatedPages, returnFilePath);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>            });</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        }</div>
</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        <span class="comment">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="preprocessor">        #region Helper methods</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span></div>
<div class="foldopen" id="foldopen00202" data-start="{" data-end="}">
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno"><a class="line" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a873032517f3fee3b737099eb78051216">  202</a></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">string</span> <a class="code hl_function" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a873032517f3fee3b737099eb78051216">GetDocumentPathAbsolute</a>(<span class="keywordtype">string</span> documentCreationSettingKey, <a class="code hl_interface" href="interface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_workspace_service.html">IWorkspaceService</a> workspaceService)</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        {</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>            <span class="keywordtype">string</span> path = workspaceService?.<a class="code hl_property" href="interface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_workspace_service.html#a1057097851e6a710c4e3acbea0075e28">Settings</a>?.GetSettingValue&lt;<span class="keywordtype">string</span>&gt;(<a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.GROUP_DOCUMENT_CREATION, documentCreationSettingKey) ?? <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>            path = FilePathHelper.MakePathAbsolute(path, workspaceService?.PersistentPath);</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>            <span class="keywordflow">return</span> path;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        }</div>
</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span></div>
<div class="foldopen" id="foldopen00214" data-start="{" data-end="}">
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno"><a class="line" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#ac9621bfd2c56d668d329e274a6463164">  214</a></span>        <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#ac9621bfd2c56d668d329e274a6463164">insertAlwaysSupportedPlaceholderValues</a>(<span class="keywordtype">string</span> templateFile, <span class="keywordtype">string</span> outputFile)</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>        {</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>            <span class="comment">// Make sure to have logic here for all values in DocumentStrategyBase&lt;TData&gt;.AlwaysSupportedPlaceholderKeys</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>            ushort competitionYear = _workspaceService?.Settings?.GetSettingValue&lt;ushort&gt;(<a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.GROUP_GENERAL, <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.SETTING_GENERAL_COMPETITIONYEAR) ?? 0;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>            DateTime competitionDate = _workspaceService?.Settings?.GetSettingValue&lt;DateTime&gt;(<a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.GROUP_GENERAL, <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.SETTING_GENERAL_COMPETITIONDATE) ?? DateTime.Today;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>            <span class="keywordtype">string</span> appVersion = <a class="code hl_namespace" href="namespace_system.html">System</a>.Reflection.Assembly.GetEntryAssembly().GetName().Version?.ToString() ?? <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>            <span class="keywordtype">string</span> workspacePath = _workspaceService?.PersistentPath ?? <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_helpers_1_1_doc_x_placeholder_helper_1_1_text_placeholders.html">DocXPlaceholderHelper.TextPlaceholders</a> textPlaceholders = <span class="keyword">new</span> DocXPlaceholderHelper.TextPlaceholders();</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>            <span class="keywordflow">foreach</span> (<span class="keywordtype">string</span> placeholder <span class="keywordflow">in</span> Placeholders.Placeholders_CompetitionYear) { textPlaceholders.Add(placeholder, competitionYear.ToString()); }</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>            <span class="keywordflow">foreach</span> (<span class="keywordtype">string</span> placeholder <span class="keywordflow">in</span> Placeholders.Placeholders_CompetitionDate) { textPlaceholders.Add(placeholder, competitionDate.ToShortDateString()); }</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>            <span class="keywordflow">foreach</span> (<span class="keywordtype">string</span> placeholder <span class="keywordflow">in</span> Placeholders.Placeholders_AppVersion) { textPlaceholders.Add(placeholder, appVersion); }</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            <span class="keywordflow">foreach</span> (<span class="keywordtype">string</span> placeholder <span class="keywordflow">in</span> Placeholders.Placeholders_WorkspacePath) { textPlaceholders.Add(placeholder, workspacePath); }</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span> </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>            DocXPlaceholderHelper.ReplaceTextPlaceholders(templateFile, outputFile, textPlaceholders, <a class="code hl_property" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a36a317416e47c4cfacf4fbf4d686507f">PlaceholderMarker</a>);</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        }</div>
</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span></div>
<div class="foldopen" id="foldopen00237" data-start="{" data-end="}">
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno"><a class="line" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#af455da544a8f265aa46c09d00870f10b">  237</a></span>        <span class="keyword">private</span> <span class="keywordtype">string</span> <a class="code hl_function" href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#af455da544a8f265aa46c09d00870f10b">convertToPdf</a>(<span class="keywordtype">string</span> docxFile)</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        {</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>            <span class="comment">// Convert the docx file to pdf</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>            <span class="keywordtype">string</span> outputFilePdf = docxFile.Replace(<span class="stringliteral">&quot;.docx&quot;</span>, <span class="stringliteral">&quot;.pdf&quot;</span>);</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            File.Delete(outputFilePdf);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>            <span class="keywordtype">string</span> libreOfficePath = _workspaceService?.Settings?.GetSettingValue&lt;<span class="keywordtype">string</span>&gt;(<a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.GROUP_DOCUMENT_CREATION, <a class="code hl_class" href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">WorkspaceSettings</a>.SETTING_DOCUMENT_CREATION_LIBRE_OFFICE_PATH) ?? <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            LibreOfficeDocumentConverter.Convert(docxFile, outputFilePdf, libreOfficePath);</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>            <span class="keywordflow">return</span> outputFilePdf;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        }</div>
</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span> </div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span><span class="preprocessor">        #endregion</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    }</div>
</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>}</div>
<div class="ttc" id="aclass_vereinsmeisterschaften_1_1_core_1_1_helpers_1_1_doc_x_placeholder_helper_1_1_table_placeholders_html"><div class="ttname"><a href="class_vereinsmeisterschaften_1_1_core_1_1_helpers_1_1_doc_x_placeholder_helper_1_1_table_placeholders.html">Vereinsmeisterschaften.Core.Helpers.DocXPlaceholderHelper.TablePlaceholders</a></div><div class="ttdoc">Class to hold table placeholders and their list of values.</div><div class="ttdef"><b>Definition</b> <a href="_doc_x_placeholder_helper_8cs_source.html#l00091">DocXPlaceholderHelper.cs:92</a></div></div>
<div class="ttc" id="aclass_vereinsmeisterschaften_1_1_core_1_1_helpers_1_1_doc_x_placeholder_helper_1_1_text_placeholders_html"><div class="ttname"><a href="class_vereinsmeisterschaften_1_1_core_1_1_helpers_1_1_doc_x_placeholder_helper_1_1_text_placeholders.html">Vereinsmeisterschaften.Core.Helpers.DocXPlaceholderHelper.TextPlaceholders</a></div><div class="ttdoc">Class to hold text placeholders and their values.</div><div class="ttdef"><b>Definition</b> <a href="_doc_x_placeholder_helper_8cs_source.html#l00024">DocXPlaceholderHelper.cs:25</a></div></div>
<div class="ttc" id="aclass_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service_html_a10fc047595a0f0ff3577db543e39e1d1"><div class="ttname"><a href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a10fc047595a0f0ff3577db543e39e1d1">Vereinsmeisterschaften.Core.Services.DocumentService.DocumentService</a></div><div class="ttdeci">DocumentService(IWorkspaceService workspaceService, IEnumerable&lt; IDocumentStrategy &gt; documentStrategies)</div><div class="ttdoc">Constructor for the DocumentService.</div><div class="ttdef"><b>Definition</b> <a href="#l00027">DocumentService.cs:27</a></div></div>
<div class="ttc" id="aclass_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service_html_a36a317416e47c4cfacf4fbf4d686507f"><div class="ttname"><a href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a36a317416e47c4cfacf4fbf4d686507f">Vereinsmeisterschaften.Core.Services.DocumentService.PlaceholderMarker</a></div><div class="ttdeci">string PlaceholderMarker</div><div class="ttdoc">Get the placeholder marker string used in the document templates.</div><div class="ttdef"><b>Definition</b> <a href="#l00039">DocumentService.cs:40</a></div></div>
<div class="ttc" id="aclass_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service_html_a873032517f3fee3b737099eb78051216"><div class="ttname"><a href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#a873032517f3fee3b737099eb78051216">Vereinsmeisterschaften.Core.Services.DocumentService.GetDocumentPathAbsolute</a></div><div class="ttdeci">static string GetDocumentPathAbsolute(string documentCreationSettingKey, IWorkspaceService workspaceService)</div><div class="ttdoc">Get the absolute path for the requested document creation setting.</div><div class="ttdef"><b>Definition</b> <a href="#l00202">DocumentService.cs:202</a></div></div>
<div class="ttc" id="aclass_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service_html_aa85ca40e7ac2bab05913439772a313b0"><div class="ttname"><a href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#aa85ca40e7ac2bab05913439772a313b0">Vereinsmeisterschaften.Core.Services.DocumentService.CreateDocument</a></div><div class="ttdeci">Task&lt;(int, string)&gt; CreateDocument(DocumentCreationTypes documentType, bool createPdf=true)</div><div class="ttdoc">Create the document indicated by the document type.</div><div class="ttdef"><b>Definition</b> <a href="#l00050">DocumentService.cs:50</a></div></div>
<div class="ttc" id="aclass_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service_html_ac9621bfd2c56d668d329e274a6463164"><div class="ttname"><a href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#ac9621bfd2c56d668d329e274a6463164">Vereinsmeisterschaften.Core.Services.DocumentService.insertAlwaysSupportedPlaceholderValues</a></div><div class="ttdeci">void insertAlwaysSupportedPlaceholderValues(string templateFile, string outputFile)</div><div class="ttdoc">Insert the values for the DocumentStrategyBase&lt;TData&gt;.AlwaysSupportedPlaceholderKeys into the templat...</div><div class="ttdef"><b>Definition</b> <a href="#l00214">DocumentService.cs:214</a></div></div>
<div class="ttc" id="aclass_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service_html_af455da544a8f265aa46c09d00870f10b"><div class="ttname"><a href="class_vereinsmeisterschaften_1_1_core_1_1_services_1_1_document_service.html#af455da544a8f265aa46c09d00870f10b">Vereinsmeisterschaften.Core.Services.DocumentService.convertToPdf</a></div><div class="ttdeci">string convertToPdf(string docxFile)</div><div class="ttdoc">Convert a .docx file to a .pdf file using LibreOffice.</div><div class="ttdef"><b>Definition</b> <a href="#l00237">DocumentService.cs:237</a></div></div>
<div class="ttc" id="aclass_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings_html"><div class="ttname"><a href="class_vereinsmeisterschaften_1_1_core_1_1_settings_1_1_workspace_settings.html">Vereinsmeisterschaften.Core.Settings.WorkspaceSettings</a></div><div class="ttdoc">Class holding all workspace settings.</div><div class="ttdef"><b>Definition</b> <a href="_workspace_settings_8cs_source.html#l00010">WorkspaceSettings.cs:11</a></div></div>
<div class="ttc" id="ainterface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_document_service_html"><div class="ttname"><a href="interface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_document_service.html">Vereinsmeisterschaften.Core.Contracts.Services.IDocumentService</a></div><div class="ttdoc">Interface for a service used to create documents like certificates or start lists.</div><div class="ttdef"><b>Definition</b> <a href="_i_document_service_8cs_source.html#l00011">IDocumentService.cs:12</a></div></div>
<div class="ttc" id="ainterface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_workspace_service_html"><div class="ttname"><a href="interface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_workspace_service.html">Vereinsmeisterschaften.Core.Contracts.Services.IWorkspaceService</a></div><div class="ttdoc">Interface for a service used to manage a workspace.</div><div class="ttdef"><b>Definition</b> <a href="_i_workspace_service_8cs_source.html#l00010">IWorkspaceService.cs:11</a></div></div>
<div class="ttc" id="ainterface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_workspace_service_html_a1057097851e6a710c4e3acbea0075e28"><div class="ttname"><a href="interface_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_1_1_i_workspace_service.html#a1057097851e6a710c4e3acbea0075e28">Vereinsmeisterschaften.Core.Contracts.Services.IWorkspaceService.Settings</a></div><div class="ttdeci">WorkspaceSettings Settings</div><div class="ttdoc">Settings for the current workspace.</div><div class="ttdef"><b>Definition</b> <a href="_i_workspace_service_8cs_source.html#l00020">IWorkspaceService.cs:20</a></div></div>
<div class="ttc" id="ainterface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy_html"><div class="ttname"><a href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html">Vereinsmeisterschaften.Core.Documents.IDocumentStrategy</a></div><div class="ttdoc">Interface for document strategies that define how to create and collect data for different types of d...</div><div class="ttdef"><b>Definition</b> <a href="_i_document_strategy_8cs_source.html#l00009">IDocumentStrategy.cs:10</a></div></div>
<div class="ttc" id="ainterface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy_html_a1d9a55ba05b8eb490c1bd9e3b77ed973"><div class="ttname"><a href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a1d9a55ba05b8eb490c1bd9e3b77ed973">Vereinsmeisterschaften.Core.Documents.IDocumentStrategy.TemplateFileNamePostfixReplaceStr</a></div><div class="ttdeci">string TemplateFileNamePostfixReplaceStr</div><div class="ttdoc">Use this string instead of the template file name postfix during document creation.</div><div class="ttdef"><b>Definition</b> <a href="_i_document_strategy_8cs_source.html#l00028">IDocumentStrategy.cs:28</a></div></div>
<div class="ttc" id="ainterface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy_html_a2903114b63845445b2372b5279b2150e"><div class="ttname"><a href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a2903114b63845445b2372b5279b2150e">Vereinsmeisterschaften.Core.Documents.IDocumentStrategy.TemplatePath</a></div><div class="ttdeci">string TemplatePath</div><div class="ttdoc">Gets the path to the template used for creating the document.</div><div class="ttdef"><b>Definition</b> <a href="_i_document_strategy_8cs_source.html#l00019">IDocumentStrategy.cs:19</a></div></div>
<div class="ttc" id="ainterface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy_html_a3db0d616407285492a03ef73862e1d72"><div class="ttname"><a href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a3db0d616407285492a03ef73862e1d72">Vereinsmeisterschaften.Core.Documents.IDocumentStrategy.GetItems</a></div><div class="ttdeci">object[] GetItems()</div><div class="ttdoc">Retrieves the items that will be used to create the document.</div></div>
<div class="ttc" id="ainterface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy_html_a8f0fafd9aa6d86ee68e307db4f5e835f"><div class="ttname"><a href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a8f0fafd9aa6d86ee68e307db4f5e835f">Vereinsmeisterschaften.Core.Documents.IDocumentStrategy.ResolveTextPlaceholders</a></div><div class="ttdeci">DocXPlaceholderHelper.TextPlaceholders ResolveTextPlaceholders(object item=null)</div><div class="ttdoc">Resolve text placeholders for the given item.</div></div>
<div class="ttc" id="ainterface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy_html_a95b76fb6866ec717c5411ef8a778a93e"><div class="ttname"><a href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#a95b76fb6866ec717c5411ef8a778a93e">Vereinsmeisterschaften.Core.Documents.IDocumentStrategy.ResolveTablePlaceholders</a></div><div class="ttdeci">DocXPlaceholderHelper.TablePlaceholders ResolveTablePlaceholders(object[] items)</div><div class="ttdoc">Resolve table placeholders for the given items.</div></div>
<div class="ttc" id="ainterface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy_html_ad422ea96c4cc00099cc5846bc1d2088c"><div class="ttname"><a href="interface_vereinsmeisterschaften_1_1_core_1_1_documents_1_1_i_document_strategy.html#ad422ea96c4cc00099cc5846bc1d2088c">Vereinsmeisterschaften.Core.Documents.IDocumentStrategy.CreateMultiplePages</a></div><div class="ttdeci">bool CreateMultiplePages</div><div class="ttdoc">Gets a value indicating whether this strategy supports creating multiple pages in the document.</div><div class="ttdef"><b>Definition</b> <a href="_i_document_strategy_8cs_source.html#l00034">IDocumentStrategy.cs:34</a></div></div>
<div class="ttc" id="anamespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div><div class="ttdef"><b>Definition</b> <a href="_frame_extensions_8cs_source.html#l00001">FrameExtensions.cs:1</a></div></div>
<div class="ttc" id="anamespace_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services_html"><div class="ttname"><a href="namespace_vereinsmeisterschaften_1_1_core_1_1_contracts_1_1_services.html">Vereinsmeisterschaften.Core.Contracts.Services</a></div><div class="ttdef"><b>Definition</b> <a href="_delegates_8cs_source.html#l00004">Delegates.cs:5</a></div></div>
<div class="ttc" id="anamespace_vereinsmeisterschaften_1_1_core_1_1_documents_html"><div class="ttname"><a href="namespace_vereinsmeisterschaften_1_1_core_1_1_documents.html">Vereinsmeisterschaften.Core.Documents</a></div><div class="ttdef"><b>Definition</b> <a href="_document_placeholder_resolver_base_8cs_source.html#l00004">DocumentPlaceholderResolverBase.cs:5</a></div></div>
<div class="ttc" id="anamespace_vereinsmeisterschaften_1_1_core_1_1_helpers_html"><div class="ttname"><a href="namespace_vereinsmeisterschaften_1_1_core_1_1_helpers.html">Vereinsmeisterschaften.Core.Helpers</a></div><div class="ttdef"><b>Definition</b> <a href="_doc_x_placeholder_helper_8cs_source.html#l00005">DocXPlaceholderHelper.cs:6</a></div></div>
<div class="ttc" id="anamespace_vereinsmeisterschaften_1_1_core_1_1_models_html"><div class="ttname"><a href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html">Vereinsmeisterschaften.Core.Models</a></div><div class="ttdef"><b>Definition</b> <a href="_competition_8cs_source.html#l00005">Competition.cs:6</a></div></div>
<div class="ttc" id="anamespace_vereinsmeisterschaften_1_1_core_1_1_models_html_a6b47c461f6af89e3ba40e8c49fbba9a6"><div class="ttname"><a href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html#a6b47c461f6af89e3ba40e8c49fbba9a6">Vereinsmeisterschaften.Core.Models.DocumentCreationTypes</a></div><div class="ttdeci">DocumentCreationTypes</div><div class="ttdoc">Different types of documents that can be created.</div><div class="ttdef"><b>Definition</b> <a href="_document_creation_types_8cs_source.html#l00006">DocumentCreationTypes.cs:7</a></div></div>
<div class="ttc" id="anamespace_vereinsmeisterschaften_1_1_core_1_1_models_html_a82b1066b34f9619bf8152e98cdb094a9"><div class="ttname"><a href="namespace_vereinsmeisterschaften_1_1_core_1_1_models.html#a82b1066b34f9619bf8152e98cdb094a9">Vereinsmeisterschaften.Core.Models.DocumentCreationFileTypes</a></div><div class="ttdeci">DocumentCreationFileTypes</div><div class="ttdoc">Different file types of documents that can be created.</div><div class="ttdef"><b>Definition</b> <a href="_document_creation_file_types_8cs_source.html#l00010">DocumentCreationFileTypes.cs:11</a></div></div>
<div class="ttc" id="anamespace_vereinsmeisterschaften_1_1_core_1_1_services_html"><div class="ttname"><a href="namespace_vereinsmeisterschaften_1_1_core_1_1_services.html">Vereinsmeisterschaften.Core.Services</a></div><div class="ttdef"><b>Definition</b> <a href="_competition_service_8cs_source.html#l00010">CompetitionService.cs:11</a></div></div>
<div class="ttc" id="anamespace_vereinsmeisterschaften_1_1_core_1_1_settings_html"><div class="ttname"><a href="namespace_vereinsmeisterschaften_1_1_core_1_1_settings.html">Vereinsmeisterschaften.Core.Settings</a></div><div class="ttdef"><b>Definition</b> <a href="_i_workspace_setting_8cs_source.html#l00003">IWorkspaceSetting.cs:4</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d79f3fde44629127f89592e101ede6a6.html">Vereinsmeisterschaften.Core</a></li><li class="navelem"><a class="el" href="dir_f885c317600d260a5b47a7877d0284fa.html">Services</a></li><li class="navelem"><b>DocumentService.cs</b></li>
    <li class="footer">Generated on Sat Nov 1 2025 19:10:36 for Vereinsmeisterschaften by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
<script type="text/javascript">
  $(document).ready(function(){
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
  })
</script>
</body>
</html>
